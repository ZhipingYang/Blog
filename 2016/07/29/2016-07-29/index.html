<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>通用链接（ Universal Links ） | Swift</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="通用链接（ Universal Links ）- 杨志平@(iOS)[universal links, 通用链接]


通过唯一的网址, 就可以链接一个特定的视图到你的 APP 里面, 不需要特别的 schema
不再需要JavaScript检查平台，跳转也不需要js去做特定处理
比scheme更灵活更安全的匹配URL跳转

注意：不能使用模拟器调试



工作原理：When the app is">
<meta property="og:type" content="article">
<meta property="og:title" content="通用链接（ Universal Links ）">
<meta property="og:url" content="http://yoursite.com/2016/07/29/2016-07-29/index.html">
<meta property="og:site_name" content="Swift">
<meta property="og:description" content="通用链接（ Universal Links ）- 杨志平@(iOS)[universal links, 通用链接]


通过唯一的网址, 就可以链接一个特定的视图到你的 APP 里面, 不需要特别的 schema
不再需要JavaScript检查平台，跳转也不需要js去做特定处理
比scheme更灵活更安全的匹配URL跳转

注意：不能使用模拟器调试



工作原理：When the app is">
<meta property="og:image" content="https://s3-eu-west-1.amazonaws.com/hoko-blog/universal_links.png">
<meta property="og:updated_time" content="2016-08-03T16:03:45.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="通用链接（ Universal Links ）">
<meta name="twitter:description" content="通用链接（ Universal Links ）- 杨志平@(iOS)[universal links, 通用链接]


通过唯一的网址, 就可以链接一个特定的视图到你的 APP 里面, 不需要特别的 schema
不再需要JavaScript检查平台，跳转也不需要js去做特定处理
比scheme更灵活更安全的匹配URL跳转

注意：不能使用模拟器调试



工作原理：When the app is">
  
    <link rel="alternative" href="/atom.xml" title="Swift" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">XcodeYang</a></h1>
		</hgroup>

		
		<p class="header-subtitle">技术</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/51offer" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/p/1006062608078012/home" title="weibo">weibo</a>
					        
								<a class="mail" target="_blank" href="/ming.z@51offer.com" title="mail">mail</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Playground/" style="font-size: 10px;">Playground</a> <a href="/tags/blog-tools-ci/" style="font-size: 10px;">blog, tools, ci</a> <a href="/tags/javaScript/" style="font-size: 10px;">javaScript</a> <a href="/tags/phython/" style="font-size: 10px;">phython</a> <a href="/tags/shell/" style="font-size: 10px;">shell</a> <a href="/tags/博客/" style="font-size: 10px;">博客</a> <a href="/tags/同步异步/" style="font-size: 10px;">同步异步</a> <a href="/tags/开发效率/" style="font-size: 10px;">开发效率</a> <a href="/tags/效率/" style="font-size: 10px;">效率</a> <a href="/tags/游戏/" style="font-size: 10px;">游戏</a> <a href="/tags/物理引擎/" style="font-size: 10px;">物理引擎</a> <a href="/tags/研发杂谈/" style="font-size: 10px;">研发杂谈</a> <a href="/tags/线程/" style="font-size: 10px;">线程</a> <a href="/tags/网站/" style="font-size: 10px;">网站</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.tomatopeter.com/">tomatopeter&#39;s blog&#39;</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://ioi.im/">ming.z&#39;s blog</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">我们是一群爱折腾的技术宅，立志在留学行业做些好玩的事。如果你相信技术拥有强大的力量，有很多有趣的念头不知在何处能实践，不妨加入我们一起切磋。。。</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">XcodeYang</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">XcodeYang</h1>
			</hgroup>
			
			<p class="header-subtitle">技术</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/51offer" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/p/1006062608078012/home" title="weibo">weibo</a>
			        
						<a class="mail" target="_blank" href="/ming.z@51offer.com" title="mail">mail</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-2016-07-29" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/07/29/2016-07-29/" class="article-date">
  	<time datetime="2016-07-29T14:30:00.000Z" itemprop="datePublished">2016-07-29</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      通用链接（ Universal Links ）
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
        
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/移动组周技术分享/">移动组周技术分享</a>
	</div>


        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="通用链接（_Universal_Links_）-_杨志平">通用链接（ Universal Links ）- 杨志平</h2><p>@(iOS)[universal links, 通用链接]</p>
<blockquote>
<ul>
<li>通过唯一的网址, 就可以链接一个特定的视图到你的 APP 里面, 不需要特别的 schema</li>
<li>不再需要JavaScript检查平台，跳转也不需要js去做特定处理</li>
<li>比scheme更灵活更安全的匹配URL跳转</li>
</ul>
<p>注意：不能使用模拟器调试</p>
</blockquote>
<p><img src="https://s3-eu-west-1.amazonaws.com/hoko-blog/universal_links.png" alt="image"></p>
<blockquote>
<p>工作原理：When the app is installed, the system downloads and verifies the site association file for each of its associated domains. If the verification is successful, the app is associated with the domain.</p>
</blockquote>
<h4 id="Configure_your_file_server">Configure your file server</h4><ul>
<li><a href="https://api-pre.51offer.com/apple-app-site-association" target="_blank" rel="external">我们的根路径配置文件</a></li>
<li><a href="https://branch.io/resources/universal-links/" target="_blank" rel="external">根路径配置有效性验证</a><h5 id="要求如下：">要求如下：</h5><blockquote>
<p>Alright! So you have your signed apple-app-site-association file. Now you just need to configure your file server to host this for you. There are a few caveats:</p>
</blockquote>
</li>
<li>It must be sent with the header ‘application/pkcs7-mime’</li>
<li>It must be sent from the endpoint youdomain.com/apple-app-site-association</li>
<li>It must return a 200 http code.</li>
</ul>
<blockquote>
<p>We set up the one for all Branch integrated apps using our Node+Express link servers. Here’s the code we used in case that’s helpful:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> aasa = fs.readFileSync(__dirname + <span class="string">'/static/apple-app-site-association'</span>);</span><br><span class="line">app.get(<span class="string">'/apple-app-site-association'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">     res.set(<span class="string">'Content-Type'</span>, <span class="string">'application/pkcs7-mime'</span>);</span><br><span class="line">     res.status(<span class="number">200</span>).send(aasa);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>可以从原有的scheme过渡过来<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)application openURL:(<span class="built_in">NSURL</span> *)url sourceApplication:(<span class="built_in">NSString</span> *)sourceApplication annotation:(<span class="keyword">id</span>)annotation &#123;</span><br><span class="line">    [<span class="keyword">self</span> handleRouting:url];</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)application continueUserActivity:(<span class="built_in">NSUserActivity</span> *)userActivity restorationHandler:(<span class="keyword">void</span> (^)(<span class="built_in">NSArray</span> *))restorationHandler &#123;</span><br><span class="line">    <span class="keyword">if</span> ([userActivity<span class="variable">.activityType</span> isEqualToString:<span class="built_in">NSUserActivityTypeBrowsingWeb</span>]) &#123;</span><br><span class="line">        [<span class="keyword">self</span> handleRouting:userActivity<span class="variable">.webpageURL</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)handleRouting:(<span class="built_in">NSURL</span> *)url &#123;</span><br><span class="line">....</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>视频</strong>优先推荐<br><a href="https://developer.apple.com/videos/play/wwdc2015/509/" target="_blank" rel="external">https://developer.apple.com/videos/play/wwdc2015/509/</a></p>
<p><strong>优秀博客</strong><br><a href="https://blog.branch.io/how-to-setup-universal-links-to-deep-link-on-apple-ios-9" target="_blank" rel="external">https://blog.branch.io/how-to-setup-universal-links-to-deep-link-on-apple-ios-9</a></p>
<p><a href="https://blog.branch.io/ios-9.2-deep-linking-guide-transitioning-to-universal-links" target="_blank" rel="external">https://blog.branch.io/ios-9.2-deep-linking-guide-transitioning-to-universal-links</a></p>
<p><a href="http://blog.hokolinks.com/how-to-implement-apple-universal-links-on-ios-9/" target="_blank" rel="external">http://blog.hokolinks.com/how-to-implement-apple-universal-links-on-ios-9/</a></p>
<p><strong>可能出现的bug</strong>（巨坑，也可能是配置问题）<br><a href="http://stackoverflow.com/questions/32751225/ios9-universal-links-does-not-work" target="_blank" rel="external">http://stackoverflow.com/questions/32751225/ios9-universal-links-does-not-work</a></p>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2016/07/22/2016-07-22/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">移动周分享-第60期</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>


<div class="share">
	<!-- JiaThis Button BEGIN -->
	<div class="jiathis_style">
		<span class="jiathis_txt">分享到：</span>
		<a class="jiathis_button_tsina"></a>
		<a class="jiathis_button_cqq"></a>
		<a class="jiathis_button_douban"></a>
		<a class="jiathis_button_weixin"></a>
		<a class="jiathis_button_tumblr"></a>
		<a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	</div>
	<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=1405949716054953" charset="utf-8"></script>
	<!-- JiaThis Button END -->
</div>



<div class="duoshuo">
	<!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="2016-07-29" data-title="通用链接（ Universal Links ）" data-url="http://yoursite.com/2016/07/29/2016-07-29/"></div>
	<!-- 多说评论框 end -->
	<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"true"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
	<!-- 多说公共JS代码 end -->
</div>




</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 XcodeYang
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>